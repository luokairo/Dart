  0%|                                                                                                         | 0/4 [00:00<?, ?it/s][[34m2025-01-20 13:48:28[0m] Begin epoch 0...
                                                                                                                                    We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
/fs/scratch/PAS2473/ICML2025/dart/models/autoencoder/quantize/dart_quantize.py:47: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
                                                                                                                                    [[34m2025-01-20 13:53:50[0m] (Generator) rec_loss: 0.0115, perceptual_loss: 0.1147, vq_loss: 6.8273,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 13:53:51[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5288, logits_fake: -1.5240
[[34m2025-01-20 13:53:51[0m] (step=0000100) Train Loss: 7.0879, Batch rFID: 459.7014, Batch gFID: 3489.4917, Avg rFID: 453.7434, Avg gFID: 3407.9220, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.31
                                                                                                                                    /fs/scratch/PAS2473/ICML2025/dart/models/autoencoder/quantize/dart_quantize.py:47: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):                                                 | 100/2802 [05:23<2:26:17,  3.25s/it]
                                                                                                                                    [[34m2025-01-20 13:59:03[0m] (Generator) rec_loss: 0.0111, perceptual_loss: 0.1109, vq_loss: 7.4742,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 13:59:04[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5103, logits_fake: -1.5084
[[34m2025-01-20 13:59:04[0m] (step=0000200) Train Loss: 7.1241, Batch rFID: 468.9797, Batch gFID: 3655.1333, Avg rFID: 444.4131, Avg gFID: 3532.7287, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 14:04:15[0m] (Generator) rec_loss: 0.0119, perceptual_loss: 0.1106, vq_loss: 7.0697,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 14:04:16[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5226, logits_fake: -1.5209
[[34m2025-01-20 14:04:16[0m] (step=0000300) Train Loss: 7.1076, Batch rFID: 485.0259, Batch gFID: 3355.3721, Avg rFID: 445.9040, Avg gFID: 3567.3225, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 14:09:28[0m] (Generator) rec_loss: 0.0121, perceptual_loss: 0.1116, vq_loss: 7.2037,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 14:09:28[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5281, logits_fake: -1.5263
[[34m2025-01-20 14:09:28[0m] (step=0000400) Train Loss: 7.0784, Batch rFID: 368.3174, Batch gFID: 3688.1692, Avg rFID: 450.2049, Avg gFID: 3581.9596, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 14:14:41[0m] (Generator) rec_loss: 0.0113, perceptual_loss: 0.1041, vq_loss: 7.0540,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 14:14:41[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5067, logits_fake: -1.5079
[[34m2025-01-20 14:14:41[0m] (step=0000500) Train Loss: 7.1408, Batch rFID: 418.8867, Batch gFID: 3498.1443, Avg rFID: 446.4396, Avg gFID: 3576.5536, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 14:19:53[0m] (Generator) rec_loss: 0.0115, perceptual_loss: 0.1063, vq_loss: 7.6204,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 14:19:54[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5239, logits_fake: -1.5242
[[34m2025-01-20 14:19:54[0m] (step=0000600) Train Loss: 7.0809, Batch rFID: 506.8782, Batch gFID: 3504.5142, Avg rFID: 448.9946, Avg gFID: 3584.3870, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 14:25:05[0m] (Generator) rec_loss: 0.0119, perceptual_loss: 0.1185, vq_loss: 7.3412,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 14:25:06[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5119, logits_fake: -1.5116
[[34m2025-01-20 14:25:06[0m] (step=0000700) Train Loss: 7.0841, Batch rFID: 468.9451, Batch gFID: 3384.3965, Avg rFID: 453.6264, Avg gFID: 3601.8520, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 14:30:18[0m] (Generator) rec_loss: 0.0127, perceptual_loss: 0.1077, vq_loss: 7.1291,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 14:30:19[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5128, logits_fake: -1.5108
[[34m2025-01-20 14:30:19[0m] (step=0000800) Train Loss: 7.0937, Batch rFID: 475.9475, Batch gFID: 3664.6233, Avg rFID: 452.4023, Avg gFID: 3614.4159, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 14:35:30[0m] (Generator) rec_loss: 0.0128, perceptual_loss: 0.1127, vq_loss: 6.5678,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 14:35:31[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5099, logits_fake: -1.5077
[[34m2025-01-20 14:35:31[0m] (step=0000900) Train Loss: 7.0999, Batch rFID: 437.7749, Batch gFID: 3615.1758, Avg rFID: 453.7201, Avg gFID: 3632.7906, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 14:40:44[0m] (Generator) rec_loss: 0.0117, perceptual_loss: 0.1111, vq_loss: 7.1991,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 14:40:44[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5134, logits_fake: -1.5100
[[34m2025-01-20 14:40:44[0m] (step=0001000) Train Loss: 7.1100, Batch rFID: 445.9478, Batch gFID: 3711.5486, Avg rFID: 449.9373, Avg gFID: 3622.2594, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
[[34m2025-01-20 14:40:45[0m] Saved checkpoint to /fs/scratch/PAS2473/ICML2025/result/vqvae/256/015-DART_tokenizer/checkpoints/0001000.pt
[[34m2025-01-20 14:40:46[0m] Saved checkpoint in cloud to /fs/scratch/PAS2473/ICML2025/logs/vqgan/256/2025-01-20-13-48-14/015-DART_tokenizer/checkpoints/0001000.pt
                                                                                                                                    [[34m2025-01-20 14:45:58[0m] (Generator) rec_loss: 0.0120, perceptual_loss: 0.1059, vq_loss: 7.1858,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 14:45:58[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5218, logits_fake: -1.5191
[[34m2025-01-20 14:45:58[0m] (step=0001100) Train Loss: 7.0988, Batch rFID: 438.9116, Batch gFID: 3546.0024, Avg rFID: 450.0897, Avg gFID: 3615.1189, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 14:51:10[0m] (Generator) rec_loss: 0.0105, perceptual_loss: 0.1026, vq_loss: 7.0762,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 14:51:11[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5149, logits_fake: -1.5154
[[34m2025-01-20 14:51:11[0m] (step=0001200) Train Loss: 7.1327, Batch rFID: 398.3479, Batch gFID: 3463.3396, Avg rFID: 453.2726, Avg gFID: 3591.6445, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 14:56:22[0m] (Generator) rec_loss: 0.0111, perceptual_loss: 0.1061, vq_loss: 7.9842,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 14:56:23[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5240, logits_fake: -1.5237
[[34m2025-01-20 14:56:23[0m] (step=0001300) Train Loss: 7.0917, Batch rFID: 511.4521, Batch gFID: 3552.5266, Avg rFID: 445.3847, Avg gFID: 3608.2858, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 15:01:34[0m] (Generator) rec_loss: 0.0106, perceptual_loss: 0.1081, vq_loss: 7.2090,codebook_usage: 99.9023, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 15:01:35[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5236, logits_fake: -1.5217
[[34m2025-01-20 15:01:35[0m] (step=0001400) Train Loss: 7.1002, Batch rFID: 503.5107, Batch gFID: 3610.2209, Avg rFID: 450.3930, Avg gFID: 3598.2875, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 15:06:47[0m] (Generator) rec_loss: 0.0097, perceptual_loss: 0.1006, vq_loss: 5.8507,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 15:06:48[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5170, logits_fake: -1.5175
[[34m2025-01-20 15:06:48[0m] (step=0001500) Train Loss: 7.1145, Batch rFID: 459.7156, Batch gFID: 3652.3892, Avg rFID: 456.5497, Avg gFID: 3601.0040, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 15:11:59[0m] (Generator) rec_loss: 0.0108, perceptual_loss: 0.1125, vq_loss: 7.3877,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 15:12:00[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5252, logits_fake: -1.5226
[[34m2025-01-20 15:12:00[0m] (step=0001600) Train Loss: 7.0938, Batch rFID: 472.5920, Batch gFID: 3677.7659, Avg rFID: 456.7359, Avg gFID: 3659.8932, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 15:17:11[0m] (Generator) rec_loss: 0.0116, perceptual_loss: 0.1080, vq_loss: 7.3174,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 15:17:12[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5111, logits_fake: -1.5104
[[34m2025-01-20 15:17:12[0m] (step=0001700) Train Loss: 7.1425, Batch rFID: 502.9478, Batch gFID: 3873.8157, Avg rFID: 450.9380, Avg gFID: 3624.6057, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 15:22:24[0m] (Generator) rec_loss: 0.0110, perceptual_loss: 0.1096, vq_loss: 6.6357,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 15:22:25[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5133, logits_fake: -1.5088
[[34m2025-01-20 15:22:25[0m] (step=0001800) Train Loss: 7.0738, Batch rFID: 509.0974, Batch gFID: 3615.5107, Avg rFID: 458.4164, Avg gFID: 3624.1131, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 15:27:36[0m] (Generator) rec_loss: 0.0120, perceptual_loss: 0.1089, vq_loss: 7.2549,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-20 15:27:37[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5208, logits_fake: -1.5180
[[34m2025-01-20 15:27:37[0m] (step=0001900) Train Loss: 7.1002, Batch rFID: 417.3469, Batch gFID: 3584.1360, Avg rFID: 454.8786, Avg gFID: 3621.9213, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 15:32:48[0m] (Generator) rec_loss: 0.0100, perceptual_loss: 0.1114, vq_loss: 7.3074,codebook_usage: 100.0000, generator_adv_loss: 0.7519, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 15:32:49[0m] (Discriminator) discriminator_adv_loss: 0.6811, disc_weight: 0.5000, logits_real: -1.5089, logits_fake: -1.5039
[[34m2025-01-20 15:32:49[0m] (step=0002000) Train Loss: 7.1300, Batch rFID: 500.3369, Batch gFID: 3728.1919, Avg rFID: 459.1081, Avg gFID: 3626.9229, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
[[34m2025-01-20 15:32:50[0m] Saved checkpoint to /fs/scratch/PAS2473/ICML2025/result/vqvae/256/015-DART_tokenizer/checkpoints/0002000.pt
[[34m2025-01-20 15:32:50[0m] Saved checkpoint in cloud to /fs/scratch/PAS2473/ICML2025/logs/vqgan/256/2025-01-20-13-48-14/015-DART_tokenizer/checkpoints/0002000.pt
                                                                                                                                    [[34m2025-01-20 15:38:02[0m] (Generator) rec_loss: 0.0135, perceptual_loss: 0.1073, vq_loss: 7.2803,codebook_usage: 100.0000, generator_adv_loss: -0.0846, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 15:38:03[0m] (Discriminator) discriminator_adv_loss: 0.5021, disc_weight: 0.5000, logits_real: 0.1616, logits_fake: 0.1691
[[34m2025-01-20 15:38:03[0m] (step=0002100) Train Loss: 7.7154, Batch rFID: 488.6887, Batch gFID: 3379.0337, Avg rFID: 493.5898, Avg gFID: 3535.0302, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 15:43:14[0m] (Generator) rec_loss: 0.0136, perceptual_loss: 0.1117, vq_loss: 6.8737,codebook_usage: 100.0000, generator_adv_loss: -0.1509, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 15:43:15[0m] (Discriminator) discriminator_adv_loss: 0.5021, disc_weight: 0.5000, logits_real: 0.2970, logits_fake: 0.3018
[[34m2025-01-20 15:43:15[0m] (step=0002200) Train Loss: 7.5872, Batch rFID: 541.1528, Batch gFID: 3706.7632, Avg rFID: 467.8068, Avg gFID: 3571.0896, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 15:48:27[0m] (Generator) rec_loss: 0.0128, perceptual_loss: 0.1103, vq_loss: 6.3153,codebook_usage: 100.0000, generator_adv_loss: 0.1292, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 15:48:28[0m] (Discriminator) discriminator_adv_loss: 0.4999, disc_weight: 0.5000, logits_real: -0.2574, logits_fake: -0.2585
[[34m2025-01-20 15:48:28[0m] (step=0002300) Train Loss: 7.6281, Batch rFID: 486.1094, Batch gFID: 3703.8767, Avg rFID: 469.4877, Avg gFID: 3655.2053, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 15:53:39[0m] (Generator) rec_loss: 0.0127, perceptual_loss: 0.1029, vq_loss: 6.8968,codebook_usage: 100.0000, generator_adv_loss: 0.1639, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 15:53:40[0m] (Discriminator) discriminator_adv_loss: 0.5021, disc_weight: 0.5000, logits_real: -0.3345, logits_fake: -0.3277
[[34m2025-01-20 15:53:40[0m] (step=0002400) Train Loss: 7.5902, Batch rFID: 472.1213, Batch gFID: 3604.7341, Avg rFID: 467.9142, Avg gFID: 3693.0106, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 15:58:52[0m] (Generator) rec_loss: 0.0123, perceptual_loss: 0.1034, vq_loss: 6.5236,codebook_usage: 100.0000, generator_adv_loss: -0.0420, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 15:58:52[0m] (Discriminator) discriminator_adv_loss: 0.5002, disc_weight: 0.5000, logits_real: 0.0833, logits_fake: 0.0839
[[34m2025-01-20 15:58:53[0m] (step=0002500) Train Loss: 7.6283, Batch rFID: 402.7773, Batch gFID: 3622.4285, Avg rFID: 473.1594, Avg gFID: 3676.1496, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 16:04:04[0m] (Generator) rec_loss: 0.0174, perceptual_loss: 0.1157, vq_loss: 7.4067,codebook_usage: 100.0000, generator_adv_loss: 0.1478, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 16:04:05[0m] (Discriminator) discriminator_adv_loss: 0.5010, disc_weight: 0.5000, logits_real: -0.2985, logits_fake: -0.2956
[[34m2025-01-20 16:04:05[0m] (step=0002600) Train Loss: 7.6446, Batch rFID: 455.2705, Batch gFID: 3700.0830, Avg rFID: 461.3134, Avg gFID: 3658.2862, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 16:09:17[0m] (Generator) rec_loss: 0.0140, perceptual_loss: 0.1113, vq_loss: 7.1486,codebook_usage: 100.0000, generator_adv_loss: -0.0191, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 16:09:18[0m] (Discriminator) discriminator_adv_loss: 0.5003, disc_weight: 0.5000, logits_real: 0.0372, logits_fake: 0.0382
[[34m2025-01-20 16:09:18[0m] (step=0002700) Train Loss: 7.6555, Batch rFID: 485.2717, Batch gFID: 3354.4619, Avg rFID: 465.9467, Avg gFID: 3675.3952, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 16:14:30[0m] (Generator) rec_loss: 0.0136, perceptual_loss: 0.1051, vq_loss: 7.4337,codebook_usage: 100.0000, generator_adv_loss: 0.1309, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 16:14:30[0m] (Discriminator) discriminator_adv_loss: 0.5011, disc_weight: 0.5000, logits_real: -0.2661, logits_fake: -0.2619
[[34m2025-01-20 16:14:31[0m] (step=0002800) Train Loss: 7.6141, Batch rFID: 536.4641, Batch gFID: 3704.5806, Avg rFID: 468.6335, Avg gFID: 3688.7531, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
100%|█████████████████████████████████████████████████████████████████████████████████████████| 2802/2802 [2:26:09<00:00,  3.13s/it]
 25%|██████████████████████▊                                                                    | 1/4 [2:26:09<7:18:27, 8769.24s/it][[34m2025-01-20 16:14:37[0m] Begin epoch 1...
                                                                                                                                    [[34m2025-01-20 16:19:48[0m] (Generator) rec_loss: 0.0148, perceptual_loss: 0.1115, vq_loss: 7.4664,codebook_usage: 99.7070, generator_adv_loss: 0.0518, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 16:19:49[0m] (Discriminator) discriminator_adv_loss: 0.5007, disc_weight: 0.5000, logits_real: -0.1065, logits_fake: -0.1035
[[34m2025-01-20 16:19:49[0m] (step=0002900) Train Loss: 7.6657, Batch rFID: 466.5752, Batch gFID: 3643.2766, Avg rFID: 459.0438, Avg gFID: 3574.3403, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.31
                                                                                                                                    [[34m2025-01-20 16:25:00[0m] (Generator) rec_loss: 0.0185, perceptual_loss: 0.1186, vq_loss: 7.1827,codebook_usage: 99.9023, generator_adv_loss: -0.0094, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 16:25:01[0m] (Discriminator) discriminator_adv_loss: 0.5010, disc_weight: 0.5000, logits_real: 0.0154, logits_fake: 0.0187
[[34m2025-01-20 16:25:01[0m] (step=0003000) Train Loss: 7.6759, Batch rFID: 495.6521, Batch gFID: 3526.7217, Avg rFID: 466.6145, Avg gFID: 3683.9037, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
[[34m2025-01-20 16:25:02[0m] Saved checkpoint to /fs/scratch/PAS2473/ICML2025/result/vqvae/256/015-DART_tokenizer/checkpoints/0003000.pt
[[34m2025-01-20 16:25:03[0m] Saved checkpoint in cloud to /fs/scratch/PAS2473/ICML2025/logs/vqgan/256/2025-01-20-13-48-14/015-DART_tokenizer/checkpoints/0003000.pt
                                                                                                                                    [[34m2025-01-20 16:30:15[0m] (Generator) rec_loss: 0.0141, perceptual_loss: 0.1124, vq_loss: 6.6945,codebook_usage: 100.0000, generator_adv_loss: 0.1134, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 16:30:16[0m] (Discriminator) discriminator_adv_loss: 0.5013, disc_weight: 0.5000, logits_real: -0.2311, logits_fake: -0.2267
[[34m2025-01-20 16:30:16[0m] (step=0003100) Train Loss: 7.6406, Batch rFID: 492.6475, Batch gFID: 3828.6116, Avg rFID: 466.7321, Avg gFID: 3698.0883, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 16:35:27[0m] (Generator) rec_loss: 0.0143, perceptual_loss: 0.1075, vq_loss: 6.6852,codebook_usage: 100.0000, generator_adv_loss: 0.1508, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 16:35:28[0m] (Discriminator) discriminator_adv_loss: 0.5017, disc_weight: 0.5000, logits_real: -0.3082, logits_fake: -0.3016
[[34m2025-01-20 16:35:28[0m] (step=0003200) Train Loss: 7.6621, Batch rFID: 505.6089, Batch gFID: 3724.6646, Avg rFID: 469.7853, Avg gFID: 3692.5306, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 16:40:40[0m] (Generator) rec_loss: 0.0142, perceptual_loss: 0.1084, vq_loss: 7.1400,codebook_usage: 100.0000, generator_adv_loss: 0.0928, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 16:40:41[0m] (Discriminator) discriminator_adv_loss: 0.5008, disc_weight: 0.5000, logits_real: -0.1889, logits_fake: -0.1856
[[34m2025-01-20 16:40:41[0m] (step=0003300) Train Loss: 7.5975, Batch rFID: 482.1592, Batch gFID: 3832.3875, Avg rFID: 469.4452, Avg gFID: 3698.9781, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 16:45:53[0m] (Generator) rec_loss: 0.0153, perceptual_loss: 0.1106, vq_loss: 7.4522,codebook_usage: 100.0000, generator_adv_loss: 0.0046, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 16:45:54[0m] (Discriminator) discriminator_adv_loss: 0.5010, disc_weight: 0.5000, logits_real: -0.0131, logits_fake: -0.0092
[[34m2025-01-20 16:45:54[0m] (step=0003400) Train Loss: 7.6082, Batch rFID: 401.4121, Batch gFID: 3594.9014, Avg rFID: 469.0014, Avg gFID: 3721.1068, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 16:51:05[0m] (Generator) rec_loss: 0.0126, perceptual_loss: 0.1077, vq_loss: 6.9521,codebook_usage: 100.0000, generator_adv_loss: 0.0279, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 16:51:06[0m] (Discriminator) discriminator_adv_loss: 0.4998, disc_weight: 0.5000, logits_real: -0.0550, logits_fake: -0.0558
[[34m2025-01-20 16:51:06[0m] (step=0003500) Train Loss: 7.6521, Batch rFID: 507.5498, Batch gFID: 3677.0522, Avg rFID: 471.0931, Avg gFID: 3709.9386, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 16:56:18[0m] (Generator) rec_loss: 0.0109, perceptual_loss: 0.1055, vq_loss: 6.4159,codebook_usage: 100.0000, generator_adv_loss: 0.0772, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 16:56:18[0m] (Discriminator) discriminator_adv_loss: 0.5005, disc_weight: 0.5000, logits_real: -0.1563, logits_fake: -0.1545
[[34m2025-01-20 16:56:18[0m] (step=0003600) Train Loss: 7.6101, Batch rFID: 477.5828, Batch gFID: 3546.8472, Avg rFID: 461.4626, Avg gFID: 3722.9437, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 17:01:30[0m] (Generator) rec_loss: 0.0179, perceptual_loss: 0.1181, vq_loss: 7.4893,codebook_usage: 100.0000, generator_adv_loss: 0.0761, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 17:01:31[0m] (Discriminator) discriminator_adv_loss: 0.5021, disc_weight: 0.5000, logits_real: -0.1605, logits_fake: -0.1523
[[34m2025-01-20 17:01:31[0m] (step=0003700) Train Loss: 7.6265, Batch rFID: 455.1021, Batch gFID: 3872.3940, Avg rFID: 480.5909, Avg gFID: 3722.7836, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 17:06:42[0m] (Generator) rec_loss: 0.0133, perceptual_loss: 0.1021, vq_loss: 6.7313,codebook_usage: 100.0000, generator_adv_loss: 0.0192, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 17:06:43[0m] (Discriminator) discriminator_adv_loss: 0.5007, disc_weight: 0.5000, logits_real: -0.0412, logits_fake: -0.0383
[[34m2025-01-20 17:06:43[0m] (step=0003800) Train Loss: 7.5603, Batch rFID: 413.7485, Batch gFID: 3869.9375, Avg rFID: 471.1260, Avg gFID: 3693.9570, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 17:11:55[0m] (Generator) rec_loss: 0.0119, perceptual_loss: 0.1081, vq_loss: 6.5656,codebook_usage: 100.0000, generator_adv_loss: -0.0812, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 17:11:55[0m] (Discriminator) discriminator_adv_loss: 0.5000, disc_weight: 0.5000, logits_real: 0.1625, logits_fake: 0.1624
[[34m2025-01-20 17:11:55[0m] (step=0003900) Train Loss: 7.6273, Batch rFID: 434.6960, Batch gFID: 3713.5928, Avg rFID: 471.3174, Avg gFID: 3736.5571, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 17:17:07[0m] (Generator) rec_loss: 0.0137, perceptual_loss: 0.1095, vq_loss: 7.4199,codebook_usage: 99.8047, generator_adv_loss: -0.0399, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 17:17:08[0m] (Discriminator) discriminator_adv_loss: 0.5005, disc_weight: 0.5000, logits_real: 0.0784, logits_fake: 0.0798
[[34m2025-01-20 17:17:08[0m] (step=0004000) Train Loss: 7.6159, Batch rFID: 495.4224, Batch gFID: 3686.5654, Avg rFID: 468.6302, Avg gFID: 3733.0969, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
[[34m2025-01-20 17:17:08[0m] Saved checkpoint to /fs/scratch/PAS2473/ICML2025/result/vqvae/256/015-DART_tokenizer/checkpoints/0004000.pt
[[34m2025-01-20 17:17:09[0m] Saved checkpoint in cloud to /fs/scratch/PAS2473/ICML2025/logs/vqgan/256/2025-01-20-13-48-14/015-DART_tokenizer/checkpoints/0004000.pt
                                                                                                                                    [[34m2025-01-20 17:22:20[0m] (Generator) rec_loss: 0.0142, perceptual_loss: 0.1071, vq_loss: 7.1514,codebook_usage: 100.0000, generator_adv_loss: 0.1361, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 17:22:21[0m] (Discriminator) discriminator_adv_loss: 0.5013, disc_weight: 0.5000, logits_real: -0.2773, logits_fake: -0.2722
[[34m2025-01-20 17:22:21[0m] (step=0004100) Train Loss: 7.6090, Batch rFID: 553.2087, Batch gFID: 3825.5205, Avg rFID: 465.0000, Avg gFID: 3763.4536, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 17:27:33[0m] (Generator) rec_loss: 0.0179, perceptual_loss: 0.1175, vq_loss: 7.2764,codebook_usage: 99.8047, generator_adv_loss: 0.0962, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 17:27:33[0m] (Discriminator) discriminator_adv_loss: 0.5018, disc_weight: 0.5000, logits_real: -0.1995, logits_fake: -0.1924
[[34m2025-01-20 17:27:33[0m] (step=0004200) Train Loss: 7.6210, Batch rFID: 447.0049, Batch gFID: 3608.8135, Avg rFID: 465.5630, Avg gFID: 3730.3489, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 17:32:45[0m] (Generator) rec_loss: 0.0120, perceptual_loss: 0.1003, vq_loss: 6.4532,codebook_usage: 100.0000, generator_adv_loss: -0.0679, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 17:32:46[0m] (Discriminator) discriminator_adv_loss: 0.5013, disc_weight: 0.5000, logits_real: 0.1306, logits_fake: 0.1357
[[34m2025-01-20 17:32:46[0m] (step=0004300) Train Loss: 7.5916, Batch rFID: 400.4888, Batch gFID: 3693.5679, Avg rFID: 471.4043, Avg gFID: 3759.9992, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 17:37:57[0m] (Generator) rec_loss: 0.0165, perceptual_loss: 0.1192, vq_loss: 6.4523,codebook_usage: 100.0000, generator_adv_loss: 0.0499, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 17:37:58[0m] (Discriminator) discriminator_adv_loss: 0.5002, disc_weight: 0.5000, logits_real: -0.1003, logits_fake: -0.0998
[[34m2025-01-20 17:37:58[0m] (step=0004400) Train Loss: 7.5867, Batch rFID: 453.0244, Batch gFID: 3794.0015, Avg rFID: 467.8917, Avg gFID: 3747.9129, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 17:43:09[0m] (Generator) rec_loss: 0.0131, perceptual_loss: 0.1156, vq_loss: 7.1328,codebook_usage: 100.0000, generator_adv_loss: -0.0564, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 17:43:10[0m] (Discriminator) discriminator_adv_loss: 0.4996, disc_weight: 0.5000, logits_real: 0.1142, logits_fake: 0.1127
[[34m2025-01-20 17:43:10[0m] (step=0004500) Train Loss: 7.6344, Batch rFID: 513.8665, Batch gFID: 3774.1304, Avg rFID: 468.4667, Avg gFID: 3777.6494, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 17:48:22[0m] (Generator) rec_loss: 0.0136, perceptual_loss: 0.1103, vq_loss: 8.4069,codebook_usage: 100.0000, generator_adv_loss: 0.0976, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 17:48:23[0m] (Discriminator) discriminator_adv_loss: 0.5003, disc_weight: 0.5000, logits_real: -0.1963, logits_fake: -0.1952
[[34m2025-01-20 17:48:23[0m] (step=0004600) Train Loss: 7.6436, Batch rFID: 430.6079, Batch gFID: 3700.0208, Avg rFID: 469.1290, Avg gFID: 3767.1642, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 17:53:34[0m] (Generator) rec_loss: 0.0158, perceptual_loss: 0.1109, vq_loss: 8.4011,codebook_usage: 100.0000, generator_adv_loss: 0.0092, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 17:53:35[0m] (Discriminator) discriminator_adv_loss: 0.5002, disc_weight: 0.5000, logits_real: -0.0193, logits_fake: -0.0184
[[34m2025-01-20 17:53:35[0m] (step=0004700) Train Loss: 7.5760, Batch rFID: 554.9119, Batch gFID: 3739.8779, Avg rFID: 462.3544, Avg gFID: 3773.7932, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 17:58:47[0m] (Generator) rec_loss: 0.0148, perceptual_loss: 0.1168, vq_loss: 6.9221,codebook_usage: 99.8779, generator_adv_loss: -0.1883, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 17:58:47[0m] (Discriminator) discriminator_adv_loss: 0.5001, disc_weight: 0.5000, logits_real: 0.3763, logits_fake: 0.3767
[[34m2025-01-20 17:58:48[0m] (step=0004800) Train Loss: 7.5639, Batch rFID: 516.0991, Batch gFID: 3505.9580, Avg rFID: 460.9828, Avg gFID: 3749.3039, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 18:03:59[0m] (Generator) rec_loss: 0.0134, perceptual_loss: 0.1101, vq_loss: 6.5099,codebook_usage: 100.0000, generator_adv_loss: -0.0464, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 18:04:00[0m] (Discriminator) discriminator_adv_loss: 0.5002, disc_weight: 0.5000, logits_real: 0.0924, logits_fake: 0.0927
[[34m2025-01-20 18:04:00[0m] (step=0004900) Train Loss: 7.5852, Batch rFID: 409.1372, Batch gFID: 3672.9661, Avg rFID: 467.7200, Avg gFID: 3789.7507, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 18:09:11[0m] (Generator) rec_loss: 0.0150, perceptual_loss: 0.1098, vq_loss: 7.4806,codebook_usage: 100.0000, generator_adv_loss: -0.0053, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 18:09:12[0m] (Discriminator) discriminator_adv_loss: 0.5004, disc_weight: 0.5000, logits_real: 0.0092, logits_fake: 0.0106
[[34m2025-01-20 18:09:12[0m] (step=0005000) Train Loss: 7.5383, Batch rFID: 465.1008, Batch gFID: 3919.6499, Avg rFID: 458.9954, Avg gFID: 3784.3370, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
[[34m2025-01-20 18:09:13[0m] Saved checkpoint to /fs/scratch/PAS2473/ICML2025/result/vqvae/256/015-DART_tokenizer/checkpoints/0005000.pt
[[34m2025-01-20 18:09:13[0m] Saved checkpoint in cloud to /fs/scratch/PAS2473/ICML2025/logs/vqgan/256/2025-01-20-13-48-14/015-DART_tokenizer/checkpoints/0005000.pt
                                                                                                                                    [[34m2025-01-20 18:14:25[0m] (Generator) rec_loss: 0.0144, perceptual_loss: 0.1088, vq_loss: 8.1629,codebook_usage: 99.7803, generator_adv_loss: -0.1060, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 18:14:26[0m] (Discriminator) discriminator_adv_loss: 0.5009, disc_weight: 0.5000, logits_real: 0.2084, logits_fake: 0.2121
[[34m2025-01-20 18:14:26[0m] (step=0005100) Train Loss: 7.5843, Batch rFID: 474.7642, Batch gFID: 3741.2400, Avg rFID: 469.7659, Avg gFID: 3786.3679, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 18:19:37[0m] (Generator) rec_loss: 0.0145, perceptual_loss: 0.1052, vq_loss: 7.0325,codebook_usage: 99.9756, generator_adv_loss: 0.0323, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 18:19:38[0m] (Discriminator) discriminator_adv_loss: 0.5011, disc_weight: 0.5000, logits_real: -0.0691, logits_fake: -0.0646
[[34m2025-01-20 18:19:38[0m] (step=0005200) Train Loss: 7.6189, Batch rFID: 420.3486, Batch gFID: 3927.5356, Avg rFID: 457.8803, Avg gFID: 3748.3501, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 18:24:50[0m] (Generator) rec_loss: 0.0138, perceptual_loss: 0.1106, vq_loss: 7.1787,codebook_usage: 100.0000, generator_adv_loss: -0.0442, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 18:24:51[0m] (Discriminator) discriminator_adv_loss: 0.5020, disc_weight: 0.5000, logits_real: 0.0814, logits_fake: 0.0884
[[34m2025-01-20 18:24:51[0m] (step=0005300) Train Loss: 7.6012, Batch rFID: 436.7849, Batch gFID: 3735.2627, Avg rFID: 468.0065, Avg gFID: 3763.7471, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 18:30:03[0m] (Generator) rec_loss: 0.0143, perceptual_loss: 0.1080, vq_loss: 6.5162,codebook_usage: 100.0000, generator_adv_loss: -0.0133, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 18:30:03[0m] (Discriminator) discriminator_adv_loss: 0.5002, disc_weight: 0.5000, logits_real: 0.0258, logits_fake: 0.0266
[[34m2025-01-20 18:30:03[0m] (step=0005400) Train Loss: 7.6352, Batch rFID: 456.6597, Batch gFID: 3583.2832, Avg rFID: 466.7251, Avg gFID: 3758.4247, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 18:35:15[0m] (Generator) rec_loss: 0.0117, perceptual_loss: 0.1025, vq_loss: 6.5225,codebook_usage: 100.0000, generator_adv_loss: -0.0303, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 18:35:16[0m] (Discriminator) discriminator_adv_loss: 0.5005, disc_weight: 0.5000, logits_real: 0.0585, logits_fake: 0.0606
[[34m2025-01-20 18:35:16[0m] (step=0005500) Train Loss: 7.5406, Batch rFID: 456.2397, Batch gFID: 3849.3438, Avg rFID: 447.7466, Avg gFID: 3754.8966, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 18:40:27[0m] (Generator) rec_loss: 0.0148, perceptual_loss: 0.1125, vq_loss: 6.4778,codebook_usage: 100.0000, generator_adv_loss: 0.0320, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 18:40:28[0m] (Discriminator) discriminator_adv_loss: 0.5000, disc_weight: 0.5000, logits_real: -0.0640, logits_fake: -0.0639
[[34m2025-01-20 18:40:28[0m] (step=0005600) Train Loss: 7.5648, Batch rFID: 501.3518, Batch gFID: 3662.8364, Avg rFID: 459.6628, Avg gFID: 3778.7656, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
100%|█████████████████████████████████████████████████████████████████████████████████████████| 2802/2802 [2:26:03<00:00,  3.13s/it]
 50%|█████████████████████████████████████████████▌                                             | 2/4 [4:52:12<4:52:11, 8765.98s/it][[34m2025-01-20 18:40:41[0m] Begin epoch 2...
                                                                                                                                    [[34m2025-01-20 18:45:45[0m] (Generator) rec_loss: 0.0146, perceptual_loss: 0.1110, vq_loss: 7.2349,codebook_usage: 100.0000, generator_adv_loss: -0.0714, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 18:45:46[0m] (Discriminator) discriminator_adv_loss: 0.5013, disc_weight: 0.5000, logits_real: 0.1376, logits_fake: 0.1429
[[34m2025-01-20 18:45:46[0m] (step=0005700) Train Loss: 7.6132, Batch rFID: 436.9216, Batch gFID: 3629.3872, Avg rFID: 448.1437, Avg gFID: 3607.8854, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.31
                                                                                                                                    [[34m2025-01-20 18:50:57[0m] (Generator) rec_loss: 0.0106, perceptual_loss: 0.1019, vq_loss: 6.3238,codebook_usage: 99.8291, generator_adv_loss: -0.0470, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 18:50:58[0m] (Discriminator) discriminator_adv_loss: 0.5012, disc_weight: 0.5000, logits_real: 0.0895, logits_fake: 0.0941
[[34m2025-01-20 18:50:58[0m] (step=0005800) Train Loss: 7.5725, Batch rFID: 431.2180, Batch gFID: 3998.6021, Avg rFID: 463.9897, Avg gFID: 3764.1556, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 18:56:10[0m] (Generator) rec_loss: 0.0151, perceptual_loss: 0.1066, vq_loss: 7.5972,codebook_usage: 100.0000, generator_adv_loss: -0.0006, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 18:56:10[0m] (Discriminator) discriminator_adv_loss: 0.5001, disc_weight: 0.5000, logits_real: 0.0008, logits_fake: 0.0012
[[34m2025-01-20 18:56:10[0m] (step=0005900) Train Loss: 7.6177, Batch rFID: 445.3232, Batch gFID: 3664.6787, Avg rFID: 469.5123, Avg gFID: 3765.1586, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 19:01:22[0m] (Generator) rec_loss: 0.0144, perceptual_loss: 0.1099, vq_loss: 7.3714,codebook_usage: 99.9756, generator_adv_loss: -0.1325, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 19:01:23[0m] (Discriminator) discriminator_adv_loss: 0.5003, disc_weight: 0.5000, logits_real: 0.2637, logits_fake: 0.2650
[[34m2025-01-20 19:01:23[0m] (step=0006000) Train Loss: 7.6083, Batch rFID: 470.6931, Batch gFID: 3654.1184, Avg rFID: 455.4432, Avg gFID: 3767.5769, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
[[34m2025-01-20 19:01:23[0m] Saved checkpoint to /fs/scratch/PAS2473/ICML2025/result/vqvae/256/015-DART_tokenizer/checkpoints/0006000.pt
[[34m2025-01-20 19:01:24[0m] Saved checkpoint in cloud to /fs/scratch/PAS2473/ICML2025/logs/vqgan/256/2025-01-20-13-48-14/015-DART_tokenizer/checkpoints/0006000.pt
                                                                                                                                    [[34m2025-01-20 19:06:36[0m] (Generator) rec_loss: 0.0153, perceptual_loss: 0.1102, vq_loss: 7.5985,codebook_usage: 100.0000, generator_adv_loss: 0.0527, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 19:06:37[0m] (Discriminator) discriminator_adv_loss: 0.5018, disc_weight: 0.5000, logits_real: -0.1128, logits_fake: -0.1055
[[34m2025-01-20 19:06:37[0m] (step=0006100) Train Loss: 7.6133, Batch rFID: 421.1265, Batch gFID: 3694.4194, Avg rFID: 462.0084, Avg gFID: 3760.0473, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 19:11:48[0m] (Generator) rec_loss: 0.0127, perceptual_loss: 0.1086, vq_loss: 6.3864,codebook_usage: 100.0000, generator_adv_loss: 0.0052, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 19:11:49[0m] (Discriminator) discriminator_adv_loss: 0.5011, disc_weight: 0.5000, logits_real: -0.0149, logits_fake: -0.0105
[[34m2025-01-20 19:11:49[0m] (step=0006200) Train Loss: 7.6163, Batch rFID: 451.8975, Batch gFID: 3597.8979, Avg rFID: 461.2313, Avg gFID: 3730.9915, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 19:17:01[0m] (Generator) rec_loss: 0.0172, perceptual_loss: 0.1152, vq_loss: 6.3163,codebook_usage: 99.8535, generator_adv_loss: 0.0569, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 19:17:01[0m] (Discriminator) discriminator_adv_loss: 0.5001, disc_weight: 0.5000, logits_real: -0.1143, logits_fake: -0.1138
[[34m2025-01-20 19:17:02[0m] (step=0006300) Train Loss: 7.6218, Batch rFID: 437.3621, Batch gFID: 3877.4692, Avg rFID: 460.2697, Avg gFID: 3765.4216, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 19:22:13[0m] (Generator) rec_loss: 0.0140, perceptual_loss: 0.1120, vq_loss: 7.1636,codebook_usage: 100.0000, generator_adv_loss: -0.0617, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 19:22:14[0m] (Discriminator) discriminator_adv_loss: 0.5001, disc_weight: 0.5000, logits_real: 0.1232, logits_fake: 0.1235
[[34m2025-01-20 19:22:14[0m] (step=0006400) Train Loss: 7.5770, Batch rFID: 492.3843, Batch gFID: 3748.9871, Avg rFID: 467.3972, Avg gFID: 3774.2296, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 19:27:26[0m] (Generator) rec_loss: 0.0151, perceptual_loss: 0.1134, vq_loss: 7.0601,codebook_usage: 100.0000, generator_adv_loss: -0.0726, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 19:27:27[0m] (Discriminator) discriminator_adv_loss: 0.5012, disc_weight: 0.5000, logits_real: 0.1407, logits_fake: 0.1453
[[34m2025-01-20 19:27:27[0m] (step=0006500) Train Loss: 7.6281, Batch rFID: 501.2139, Batch gFID: 3621.7869, Avg rFID: 462.8571, Avg gFID: 3749.9759, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 19:32:39[0m] (Generator) rec_loss: 0.0126, perceptual_loss: 0.1085, vq_loss: 6.8868,codebook_usage: 99.9756, generator_adv_loss: -0.0502, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 19:32:39[0m] (Discriminator) discriminator_adv_loss: 0.5014, disc_weight: 0.5000, logits_real: 0.0948, logits_fake: 0.1004
[[34m2025-01-20 19:32:39[0m] (step=0006600) Train Loss: 7.6058, Batch rFID: 482.0356, Batch gFID: 3677.2588, Avg rFID: 458.4804, Avg gFID: 3754.9036, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 19:37:51[0m] (Generator) rec_loss: 0.0127, perceptual_loss: 0.1090, vq_loss: 6.5019,codebook_usage: 100.0000, generator_adv_loss: -0.0540, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 19:37:52[0m] (Discriminator) discriminator_adv_loss: 0.5009, disc_weight: 0.5000, logits_real: 0.1044, logits_fake: 0.1081
[[34m2025-01-20 19:37:52[0m] (step=0006700) Train Loss: 7.5705, Batch rFID: 363.3513, Batch gFID: 3876.8564, Avg rFID: 455.7409, Avg gFID: 3748.3304, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 19:43:03[0m] (Generator) rec_loss: 0.0108, perceptual_loss: 0.0987, vq_loss: 6.5420,codebook_usage: 100.0000, generator_adv_loss: 0.0738, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 19:43:04[0m] (Discriminator) discriminator_adv_loss: 0.5006, disc_weight: 0.5000, logits_real: -0.1501, logits_fake: -0.1476
[[34m2025-01-20 19:43:04[0m] (step=0006800) Train Loss: 7.6080, Batch rFID: 513.4526, Batch gFID: 3833.8438, Avg rFID: 454.6956, Avg gFID: 3757.7416, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 19:48:16[0m] (Generator) rec_loss: 0.0179, perceptual_loss: 0.1184, vq_loss: 7.3030,codebook_usage: 100.0000, generator_adv_loss: 0.0011, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 19:48:17[0m] (Discriminator) discriminator_adv_loss: 0.5012, disc_weight: 0.5000, logits_real: -0.0069, logits_fake: -0.0023
[[34m2025-01-20 19:48:17[0m] (step=0006900) Train Loss: 7.6435, Batch rFID: 509.7861, Batch gFID: 3927.9600, Avg rFID: 459.2689, Avg gFID: 3760.6864, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 19:53:28[0m] (Generator) rec_loss: 0.0152, perceptual_loss: 0.1131, vq_loss: 7.4273,codebook_usage: 100.0000, generator_adv_loss: 0.0355, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 19:53:29[0m] (Discriminator) discriminator_adv_loss: 0.5024, disc_weight: 0.5000, logits_real: -0.0790, logits_fake: -0.0711
[[34m2025-01-20 19:53:29[0m] (step=0007000) Train Loss: 7.5568, Batch rFID: 494.0425, Batch gFID: 4016.1572, Avg rFID: 452.2318, Avg gFID: 3764.6476, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
[[34m2025-01-20 19:53:30[0m] Saved checkpoint to /fs/scratch/PAS2473/ICML2025/result/vqvae/256/015-DART_tokenizer/checkpoints/0007000.pt
[[34m2025-01-20 19:53:30[0m] Saved checkpoint in cloud to /fs/scratch/PAS2473/ICML2025/logs/vqgan/256/2025-01-20-13-48-14/015-DART_tokenizer/checkpoints/0007000.pt
                                                                                                                                    [[34m2025-01-20 19:58:42[0m] (Generator) rec_loss: 0.0122, perceptual_loss: 0.1112, vq_loss: 5.7446,codebook_usage: 100.0000, generator_adv_loss: 0.0605, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 19:58:43[0m] (Discriminator) discriminator_adv_loss: 0.5006, disc_weight: 0.5000, logits_real: -0.1233, logits_fake: -0.1209
[[34m2025-01-20 19:58:43[0m] (step=0007100) Train Loss: 7.5600, Batch rFID: 385.2510, Batch gFID: 3689.8081, Avg rFID: 452.9088, Avg gFID: 3774.5624, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 20:03:55[0m] (Generator) rec_loss: 0.0126, perceptual_loss: 0.1111, vq_loss: 6.1438,codebook_usage: 100.0000, generator_adv_loss: -0.0376, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 20:03:55[0m] (Discriminator) discriminator_adv_loss: 0.5005, disc_weight: 0.5000, logits_real: 0.0731, logits_fake: 0.0752
[[34m2025-01-20 20:03:55[0m] (step=0007200) Train Loss: 7.5694, Batch rFID: 461.2988, Batch gFID: 3843.0303, Avg rFID: 460.6985, Avg gFID: 3774.0963, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 20:09:07[0m] (Generator) rec_loss: 0.0147, perceptual_loss: 0.1126, vq_loss: 7.4496,codebook_usage: 99.8779, generator_adv_loss: -0.0751, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 20:09:07[0m] (Discriminator) discriminator_adv_loss: 0.5008, disc_weight: 0.5000, logits_real: 0.1472, logits_fake: 0.1502
[[34m2025-01-20 20:09:08[0m] (step=0007300) Train Loss: 7.6020, Batch rFID: 480.2710, Batch gFID: 3601.3113, Avg rFID: 445.0442, Avg gFID: 3760.9910, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 20:14:19[0m] (Generator) rec_loss: 0.0143, perceptual_loss: 0.1134, vq_loss: 7.1920,codebook_usage: 100.0000, generator_adv_loss: 0.0223, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 20:14:20[0m] (Discriminator) discriminator_adv_loss: 0.5002, disc_weight: 0.5000, logits_real: -0.0454, logits_fake: -0.0446
[[34m2025-01-20 20:14:20[0m] (step=0007400) Train Loss: 7.6185, Batch rFID: 404.6411, Batch gFID: 3800.0381, Avg rFID: 451.8441, Avg gFID: 3795.5663, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 20:19:32[0m] (Generator) rec_loss: 0.0132, perceptual_loss: 0.1116, vq_loss: 6.9140,codebook_usage: 100.0000, generator_adv_loss: 0.0011, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 20:19:32[0m] (Discriminator) discriminator_adv_loss: 0.5015, disc_weight: 0.5000, logits_real: -0.0076, logits_fake: -0.0023
[[34m2025-01-20 20:19:32[0m] (step=0007500) Train Loss: 7.6364, Batch rFID: 405.9973, Batch gFID: 3607.4297, Avg rFID: 450.0078, Avg gFID: 3771.8179, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 20:24:44[0m] (Generator) rec_loss: 0.0127, perceptual_loss: 0.1062, vq_loss: 7.2122,codebook_usage: 100.0000, generator_adv_loss: 0.0610, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 20:24:45[0m] (Discriminator) discriminator_adv_loss: 0.5011, disc_weight: 0.5000, logits_real: -0.1266, logits_fake: -0.1221
[[34m2025-01-20 20:24:45[0m] (step=0007600) Train Loss: 7.6219, Batch rFID: 484.7712, Batch gFID: 3880.6619, Avg rFID: 459.7221, Avg gFID: 3803.7094, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 20:29:57[0m] (Generator) rec_loss: 0.0168, perceptual_loss: 0.1161, vq_loss: 7.4743,codebook_usage: 100.0000, generator_adv_loss: 0.0369, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 20:29:58[0m] (Discriminator) discriminator_adv_loss: 0.4996, disc_weight: 0.5000, logits_real: -0.0721, logits_fake: -0.0738
[[34m2025-01-20 20:29:58[0m] (step=0007700) Train Loss: 7.5653, Batch rFID: 426.0923, Batch gFID: 3669.4231, Avg rFID: 449.1832, Avg gFID: 3792.3151, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 20:35:09[0m] (Generator) rec_loss: 0.0138, perceptual_loss: 0.1040, vq_loss: 7.3380,codebook_usage: 99.8291, generator_adv_loss: 0.0286, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 20:35:10[0m] (Discriminator) discriminator_adv_loss: 0.5008, disc_weight: 0.5000, logits_real: -0.0604, logits_fake: -0.0572
[[34m2025-01-20 20:35:10[0m] (step=0007800) Train Loss: 7.6179, Batch rFID: 388.8606, Batch gFID: 3814.2937, Avg rFID: 451.8789, Avg gFID: 3819.8031, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 20:40:22[0m] (Generator) rec_loss: 0.0155, perceptual_loss: 0.1128, vq_loss: 7.8385,codebook_usage: 100.0000, generator_adv_loss: -0.0524, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 20:40:23[0m] (Discriminator) discriminator_adv_loss: 0.5014, disc_weight: 0.5000, logits_real: 0.0992, logits_fake: 0.1048
[[34m2025-01-20 20:40:23[0m] (step=0007900) Train Loss: 7.5809, Batch rFID: 580.5110, Batch gFID: 3763.2908, Avg rFID: 458.9096, Avg gFID: 3780.8644, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 20:45:34[0m] (Generator) rec_loss: 0.0162, perceptual_loss: 0.1098, vq_loss: 6.7702,codebook_usage: 99.8779, generator_adv_loss: 0.0335, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 20:45:35[0m] (Discriminator) discriminator_adv_loss: 0.5010, disc_weight: 0.5000, logits_real: -0.0712, logits_fake: -0.0671
[[34m2025-01-20 20:45:35[0m] (step=0008000) Train Loss: 7.5838, Batch rFID: 433.7480, Batch gFID: 3700.8101, Avg rFID: 448.0728, Avg gFID: 3777.6674, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
[[34m2025-01-20 20:45:36[0m] Saved checkpoint to /fs/scratch/PAS2473/ICML2025/result/vqvae/256/015-DART_tokenizer/checkpoints/0008000.pt
[[34m2025-01-20 20:45:36[0m] Saved checkpoint in cloud to /fs/scratch/PAS2473/ICML2025/logs/vqgan/256/2025-01-20-13-48-14/015-DART_tokenizer/checkpoints/0008000.pt
                                                                                                                                    [[34m2025-01-20 20:50:48[0m] (Generator) rec_loss: 0.0135, perceptual_loss: 0.1097, vq_loss: 6.9154,codebook_usage: 100.0000, generator_adv_loss: 0.0144, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 20:50:49[0m] (Discriminator) discriminator_adv_loss: 0.5003, disc_weight: 0.5000, logits_real: -0.0301, logits_fake: -0.0289
[[34m2025-01-20 20:50:49[0m] (step=0008100) Train Loss: 7.6018, Batch rFID: 514.6294, Batch gFID: 3763.5610, Avg rFID: 451.0693, Avg gFID: 3804.1880, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 20:56:01[0m] (Generator) rec_loss: 0.0161, perceptual_loss: 0.1047, vq_loss: 6.8047,codebook_usage: 100.0000, generator_adv_loss: -0.1306, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 20:56:01[0m] (Discriminator) discriminator_adv_loss: 0.5008, disc_weight: 0.5000, logits_real: 0.2582, logits_fake: 0.2611
[[34m2025-01-20 20:56:01[0m] (step=0008200) Train Loss: 7.6182, Batch rFID: 444.9583, Batch gFID: 3854.9646, Avg rFID: 442.9954, Avg gFID: 3791.9831, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 21:01:13[0m] (Generator) rec_loss: 0.0146, perceptual_loss: 0.1124, vq_loss: 6.5799,codebook_usage: 100.0000, generator_adv_loss: -0.1069, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 21:01:14[0m] (Discriminator) discriminator_adv_loss: 0.4997, disc_weight: 0.5000, logits_real: 0.2150, logits_fake: 0.2139
[[34m2025-01-20 21:01:14[0m] (step=0008300) Train Loss: 7.6067, Batch rFID: 459.2095, Batch gFID: 3805.1274, Avg rFID: 448.8373, Avg gFID: 3813.9057, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 21:06:26[0m] (Generator) rec_loss: 0.0139, perceptual_loss: 0.1096, vq_loss: 7.0351,codebook_usage: 99.7803, generator_adv_loss: 0.0455, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 21:06:27[0m] (Discriminator) discriminator_adv_loss: 0.5009, disc_weight: 0.5000, logits_real: -0.0944, logits_fake: -0.0910
[[34m2025-01-20 21:06:27[0m] (step=0008400) Train Loss: 7.6246, Batch rFID: 466.5317, Batch gFID: 4018.7725, Avg rFID: 450.9217, Avg gFID: 3803.7398, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
100%|█████████████████████████████████████████████████████████████████████████████████████████| 2802/2802 [2:26:04<00:00,  3.13s/it]
 75%|████████████████████████████████████████████████████████████████████▎                      | 3/4 [7:18:17<2:26:05, 8765.44s/it][[34m2025-01-20 21:06:46[0m] Begin epoch 3...
                                                                                                                                    [[34m2025-01-20 21:11:44[0m] (Generator) rec_loss: 0.0125, perceptual_loss: 0.1117, vq_loss: 6.2431,codebook_usage: 99.7803, generator_adv_loss: -0.1216, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 21:11:45[0m] (Discriminator) discriminator_adv_loss: 0.5004, disc_weight: 0.5000, logits_real: 0.2418, logits_fake: 0.2433
[[34m2025-01-20 21:11:45[0m] (step=0008500) Train Loss: 7.5678, Batch rFID: 446.8501, Batch gFID: 3928.5654, Avg rFID: 424.4449, Avg gFID: 3536.1553, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.31
                                                                                                                                    [[34m2025-01-20 21:16:57[0m] (Generator) rec_loss: 0.0160, perceptual_loss: 0.1112, vq_loss: 7.2978,codebook_usage: 100.0000, generator_adv_loss: -0.0208, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 21:16:58[0m] (Discriminator) discriminator_adv_loss: 0.5000, disc_weight: 0.5000, logits_real: 0.0417, logits_fake: 0.0416
[[34m2025-01-20 21:16:58[0m] (step=0008600) Train Loss: 7.6459, Batch rFID: 482.0134, Batch gFID: 3735.2236, Avg rFID: 448.6258, Avg gFID: 3761.2413, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 21:22:09[0m] (Generator) rec_loss: 0.0144, perceptual_loss: 0.1170, vq_loss: 6.9541,codebook_usage: 99.7559, generator_adv_loss: 0.0729, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 21:22:10[0m] (Discriminator) discriminator_adv_loss: 0.5009, disc_weight: 0.5000, logits_real: -0.1489, logits_fake: -0.1458
[[34m2025-01-20 21:22:10[0m] (step=0008700) Train Loss: 7.5990, Batch rFID: 525.2974, Batch gFID: 3986.0811, Avg rFID: 451.2257, Avg gFID: 3771.7538, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 21:27:22[0m] (Generator) rec_loss: 0.0136, perceptual_loss: 0.1128, vq_loss: 7.5043,codebook_usage: 100.0000, generator_adv_loss: -0.1335, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 21:27:22[0m] (Discriminator) discriminator_adv_loss: 0.5005, disc_weight: 0.5000, logits_real: 0.2651, logits_fake: 0.2670
[[34m2025-01-20 21:27:22[0m] (step=0008800) Train Loss: 7.6113, Batch rFID: 495.8828, Batch gFID: 3633.7942, Avg rFID: 450.7733, Avg gFID: 3780.7650, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 21:32:34[0m] (Generator) rec_loss: 0.0151, perceptual_loss: 0.1191, vq_loss: 7.0497,codebook_usage: 100.0000, generator_adv_loss: 0.0142, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 21:32:35[0m] (Discriminator) discriminator_adv_loss: 0.4998, disc_weight: 0.5000, logits_real: -0.0274, logits_fake: -0.0283
[[34m2025-01-20 21:32:35[0m] (step=0008900) Train Loss: 7.6001, Batch rFID: 423.6301, Batch gFID: 3810.8936, Avg rFID: 449.2187, Avg gFID: 3792.3845, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 21:37:46[0m] (Generator) rec_loss: 0.0122, perceptual_loss: 0.1013, vq_loss: 6.0506,codebook_usage: 100.0000, generator_adv_loss: 0.0389, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 21:37:47[0m] (Discriminator) discriminator_adv_loss: 0.5012, disc_weight: 0.5000, logits_real: -0.0827, logits_fake: -0.0778
[[34m2025-01-20 21:37:47[0m] (step=0009000) Train Loss: 7.5788, Batch rFID: 417.4282, Batch gFID: 3738.7515, Avg rFID: 439.9034, Avg gFID: 3788.2262, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
[[34m2025-01-20 21:37:48[0m] Saved checkpoint to /fs/scratch/PAS2473/ICML2025/result/vqvae/256/015-DART_tokenizer/checkpoints/0009000.pt
[[34m2025-01-20 21:37:49[0m] Saved checkpoint in cloud to /fs/scratch/PAS2473/ICML2025/logs/vqgan/256/2025-01-20-13-48-14/015-DART_tokenizer/checkpoints/0009000.pt
                                                                                                                                    [[34m2025-01-20 21:43:00[0m] (Generator) rec_loss: 0.0161, perceptual_loss: 0.1136, vq_loss: 8.0329,codebook_usage: 100.0000, generator_adv_loss: 0.0752, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 21:43:01[0m] (Discriminator) discriminator_adv_loss: 0.5009, disc_weight: 0.5000, logits_real: -0.1539, logits_fake: -0.1503
[[34m2025-01-20 21:43:01[0m] (step=0009100) Train Loss: 7.6659, Batch rFID: 509.6411, Batch gFID: 3911.2537, Avg rFID: 445.2533, Avg gFID: 3795.5937, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 21:48:13[0m] (Generator) rec_loss: 0.0150, perceptual_loss: 0.1125, vq_loss: 7.7678,codebook_usage: 100.0000, generator_adv_loss: -0.1182, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 21:48:14[0m] (Discriminator) discriminator_adv_loss: 0.5000, disc_weight: 0.5000, logits_real: 0.2365, logits_fake: 0.2363
[[34m2025-01-20 21:48:14[0m] (step=0009200) Train Loss: 7.6069, Batch rFID: 565.6538, Batch gFID: 3809.8940, Avg rFID: 444.6584, Avg gFID: 3798.5514, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 21:53:26[0m] (Generator) rec_loss: 0.0148, perceptual_loss: 0.1063, vq_loss: 7.8913,codebook_usage: 100.0000, generator_adv_loss: -0.1084, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 21:53:26[0m] (Discriminator) discriminator_adv_loss: 0.5008, disc_weight: 0.5000, logits_real: 0.2143, logits_fake: 0.2168
[[34m2025-01-20 21:53:26[0m] (step=0009300) Train Loss: 7.6380, Batch rFID: 445.2791, Batch gFID: 3769.9905, Avg rFID: 448.4207, Avg gFID: 3793.8680, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 21:58:38[0m] (Generator) rec_loss: 0.0161, perceptual_loss: 0.1085, vq_loss: 6.9168,codebook_usage: 100.0000, generator_adv_loss: 0.0310, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 21:58:39[0m] (Discriminator) discriminator_adv_loss: 0.5015, disc_weight: 0.5000, logits_real: -0.0680, logits_fake: -0.0620
[[34m2025-01-20 21:58:39[0m] (step=0009400) Train Loss: 7.6362, Batch rFID: 468.8311, Batch gFID: 3812.8062, Avg rFID: 452.0313, Avg gFID: 3826.6065, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 22:03:51[0m] (Generator) rec_loss: 0.0135, perceptual_loss: 0.1102, vq_loss: 7.0014,codebook_usage: 99.8535, generator_adv_loss: 0.0854, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 22:03:51[0m] (Discriminator) discriminator_adv_loss: 0.5006, disc_weight: 0.5000, logits_real: -0.1732, logits_fake: -0.1708
[[34m2025-01-20 22:03:51[0m] (step=0009500) Train Loss: 7.6229, Batch rFID: 474.2954, Batch gFID: 3783.5669, Avg rFID: 448.9583, Avg gFID: 3793.3383, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 22:09:03[0m] (Generator) rec_loss: 0.0170, perceptual_loss: 0.1193, vq_loss: 7.9293,codebook_usage: 100.0000, generator_adv_loss: -0.0246, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 22:09:04[0m] (Discriminator) discriminator_adv_loss: 0.5002, disc_weight: 0.5000, logits_real: 0.0485, logits_fake: 0.0493
[[34m2025-01-20 22:09:04[0m] (step=0009600) Train Loss: 7.5581, Batch rFID: 480.1702, Batch gFID: 3757.5430, Avg rFID: 444.8067, Avg gFID: 3790.7667, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 22:14:15[0m] (Generator) rec_loss: 0.0142, perceptual_loss: 0.1109, vq_loss: 6.4574,codebook_usage: 100.0000, generator_adv_loss: 0.1441, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 22:14:16[0m] (Discriminator) discriminator_adv_loss: 0.5022, disc_weight: 0.5000, logits_real: -0.2967, logits_fake: -0.2882
[[34m2025-01-20 22:14:16[0m] (step=0009700) Train Loss: 7.5781, Batch rFID: 383.6360, Batch gFID: 3884.8130, Avg rFID: 441.2853, Avg gFID: 3777.9313, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
                                                                                                                                    [[34m2025-01-20 22:19:28[0m] (Generator) rec_loss: 0.0139, perceptual_loss: 0.1090, vq_loss: 7.2211,codebook_usage: 100.0000, generator_adv_loss: -0.0554, disc_adaptive_weight: 1.0000, disc_weight: 0.5000
[[34m2025-01-20 22:19:29[0m] (Discriminator) discriminator_adv_loss: 0.5004, disc_weight: 0.5000, logits_real: 0.1093, logits_fake: 0.1107
[[34m2025-01-20 22:19:29[0m] (step=0009800) Train Loss: 7.6165, Batch rFID: 458.9312, Batch gFID: 3684.8994, Avg rFID: 450.3019, Avg gFID: 3774.8705, continuous: 0.5000, discrete: 0.5000Train Steps/Sec: 0.32
 53%|█████████████████████████████████████████████▊                                         | 1475/2802 [1:16:58<1:09:14,  3.13s/it]
 75%|███████████████████████████████████████████████████████████████████▌                      | 3/4 [8:35:15<2:51:45, 10305.29s/it]
Traceback (most recent call last):
  File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 538, in <module>
    parser.add_argument("--image-size", type=int, default=256, choices=[256, 512, 1024],
  File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 340, in main
    rfid = calculate_fid(real_mu, real_sigma, gen_mu, gen_sigma)
  File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_loss.py", line 59, in calculate_fid
    u, s, v = torch.svd(torch.matmul(sigma1, sigma2))
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 538, in <module>
[rank0]:     parser.add_argument("--image-size", type=int, default=256, choices=[256, 512, 1024],
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 340, in main
[rank0]:     rfid = calculate_fid(real_mu, real_sigma, gen_mu, gen_sigma)
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_loss.py", line 59, in calculate_fid
[rank0]:     u, s, v = torch.svd(torch.matmul(sigma1, sigma2))
[rank0]: KeyboardInterrupt
