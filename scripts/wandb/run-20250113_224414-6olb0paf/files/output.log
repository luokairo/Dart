  0%|                                                                                                                              | 0/100 [00:00<?, ?it/s][[34m2025-01-13 22:44:15[0m] Begin epoch 0...
                                                                                                                                                           [rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] WON'T CONVERT forward /fs/scratch/PAS2473/ICML2025/dart/models/autoencoder/dart_autoencoder.py line 138
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] due to:                                 | 0/13617 [00:00<?, ?it/s]
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Traceback (most recent call last):
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1446, in _call_user_compiler
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = compiler_fn(gm, self.example_inputs())
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/backends/distributed.py", line 506, in compile_fn
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self.backend_compile_fn(gm, example_inputs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/repro/after_dynamo.py", line 129, in __call__
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_gm = compiler_fn(gm, example_inputs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/__init__.py", line 2234, in __call__
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return compile_fx(model_, inputs_, config_patches=self.config)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1521, in compile_fx
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return aot_autograd(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/backends/common.py", line 72, in __call__
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     cg = aot_module_simplified(gm, example_inputs, **self.kwargs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1071, in aot_module_simplified
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = dispatch_and_compile()
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1056, in dispatch_and_compile
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn, _ = create_aot_dispatcher_function(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 522, in create_aot_dispatcher_function
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _create_aot_dispatcher_function(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 759, in _create_aot_dispatcher_function
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn, fw_metadata = compiler_fn(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/jit_compile_runtime_wrappers.py", line 179, in aot_dispatch_base
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fw = compiler(fw_module, updated_flat_args)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1350, in fw_compiler_base
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _fw_compiler_base(model, example_inputs, is_inference)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1421, in _fw_compiler_base
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return inner_compile(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 475, in compile_fx_inner
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return wrap_compiler_debug(_compile_fx_inner, compiler_name="inductor")(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/repro/after_aot.py", line 85, in debug_wrapper
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     inner_compiled_fn = compiler_fn(gm, example_inputs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 661, in _compile_fx_inner
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = FxGraphCache.load(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1334, in load
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = compile_fx_fn(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 570, in codegen_and_compile
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = fx_codegen_and_compile(gm, example_inputs, **fx_kwargs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 878, in fx_codegen_and_compile
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = graph.compile_to_fn()
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1913, in compile_to_fn
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self.compile_to_module().call
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1839, in compile_to_module
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self._compile_to_module()
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1867, in _compile_to_module
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = PyCodeCache.load_by_key_path(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = _reload_python_module(key, path)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     exec(code, mod.__dict__, mod.__dict__)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/tmp/slurmtmp.281813/torchinductor_brucewan666/or/corx3fu3opylhrdrobhao4ibwr6p7l3cmopmpjhgenn6meszhepb.py", line 193, in <module>
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     triton_poi_fused__to_copy_native_group_norm_silu_3 = async_compile.triton('triton_', '''
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/async_compile.py", line 188, in triton
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     kernel = TritonCodeCache.load(kernel_name, source_code)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2926, in load
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _module_to_triton_kernel(PyCodeCache.load(source_code), kernel_name)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2863, in load
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return cls.load_by_key_path(key, path, linemap, attrs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = _reload_python_module(key, path)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     exec(code, mod.__dict__, mod.__dict__)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/tmp/slurmtmp.281813/torchinductor_brucewan666/b6/cb6jibpjwzb7zu5ysllqdmheceu5bpbjpvsg7pvxci5cawtku52d.py", line 10, in <module>
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     @triton_heuristics.pointwise(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/triton_heuristics.py", line 1368, in pointwise
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     triton_config_with_settings(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/triton_heuristics.py", line 1244, in triton_config
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     assert x <= TRITON_MAX_BLOCK["X"], f"increase TRITON_MAX_BLOCK['X'] to {x}"
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] AssertionError: increase TRITON_MAX_BLOCK['X'] to 4096
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] The above exception was the direct cause of the following exception:
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Traceback (most recent call last):
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1064, in __call__
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     result = self._inner_convert(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 526, in __call__
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _compile(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 924, in _compile
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 666, in compile_inner
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_utils_internal.py", line 87, in wrapper_function
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return function(*args, **kwargs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 699, in _compile_inner
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     out_code = transform_code_object(code, transform)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1322, in transform_code_object
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     transformations(instructions, code_options)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 219, in _fn
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return fn(*args, **kwargs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 634, in transform
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     tracer.run()
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2796, in run
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     super().run()
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 983, in run
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     while self.step():
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 895, in step
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 580, in wrapper
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return handle_graph_break(self, inst, speculation.reason)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 649, in handle_graph_break
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.output.compile_subgraph(self, reason=reason)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1142, in compile_subgraph
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1369, in compile_and_call_fx_graph
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = self.call_user_compiler(gm)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1416, in call_user_compiler
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self._call_user_compiler(gm)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1465, in _call_user_compiler
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     raise BackendCompilerFailed(self.compiler_fn, e) from e
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] torch._dynamo.exc.BackendCompilerFailed: backend='compile_fn' raised:
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] AssertionError: increase TRITON_MAX_BLOCK['X'] to 4096
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Traceback (most recent call last):
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1446, in _call_user_compiler
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = compiler_fn(gm, self.example_inputs())
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/backends/distributed.py", line 506, in compile_fn
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self.backend_compile_fn(gm, example_inputs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/repro/after_dynamo.py", line 129, in __call__
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_gm = compiler_fn(gm, example_inputs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/__init__.py", line 2234, in __call__
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return compile_fx(model_, inputs_, config_patches=self.config)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1521, in compile_fx
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return aot_autograd(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/backends/common.py", line 72, in __call__
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     cg = aot_module_simplified(gm, example_inputs, **self.kwargs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1071, in aot_module_simplified
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = dispatch_and_compile()
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1056, in dispatch_and_compile
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn, _ = create_aot_dispatcher_function(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 522, in create_aot_dispatcher_function
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _create_aot_dispatcher_function(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 759, in _create_aot_dispatcher_function
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn, fw_metadata = compiler_fn(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/jit_compile_runtime_wrappers.py", line 179, in aot_dispatch_base
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fw = compiler(fw_module, updated_flat_args)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1350, in fw_compiler_base
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _fw_compiler_base(model, example_inputs, is_inference)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1421, in _fw_compiler_base
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return inner_compile(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 475, in compile_fx_inner
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return wrap_compiler_debug(_compile_fx_inner, compiler_name="inductor")(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/repro/after_aot.py", line 85, in debug_wrapper
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     inner_compiled_fn = compiler_fn(gm, example_inputs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 661, in _compile_fx_inner
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = FxGraphCache.load(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1334, in load
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = compile_fx_fn(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 570, in codegen_and_compile
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = fx_codegen_and_compile(gm, example_inputs, **fx_kwargs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 878, in fx_codegen_and_compile
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = graph.compile_to_fn()
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1913, in compile_to_fn
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self.compile_to_module().call
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1839, in compile_to_module
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self._compile_to_module()
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1867, in _compile_to_module
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = PyCodeCache.load_by_key_path(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = _reload_python_module(key, path)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     exec(code, mod.__dict__, mod.__dict__)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/tmp/slurmtmp.281813/torchinductor_brucewan666/or/corx3fu3opylhrdrobhao4ibwr6p7l3cmopmpjhgenn6meszhepb.py", line 193, in <module>
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     triton_poi_fused__to_copy_native_group_norm_silu_3 = async_compile.triton('triton_', '''
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/async_compile.py", line 188, in triton
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     kernel = TritonCodeCache.load(kernel_name, source_code)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2926, in load
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _module_to_triton_kernel(PyCodeCache.load(source_code), kernel_name)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2863, in load
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return cls.load_by_key_path(key, path, linemap, attrs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = _reload_python_module(key, path)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     exec(code, mod.__dict__, mod.__dict__)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/tmp/slurmtmp.281813/torchinductor_brucewan666/b6/cb6jibpjwzb7zu5ysllqdmheceu5bpbjpvsg7pvxci5cawtku52d.py", line 10, in <module>
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     @triton_heuristics.pointwise(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/triton_heuristics.py", line 1368, in pointwise
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     triton_config_with_settings(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/triton_heuristics.py", line 1244, in triton_config
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     assert x <= TRITON_MAX_BLOCK["X"], f"increase TRITON_MAX_BLOCK['X'] to {x}"
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] AssertionError: increase TRITON_MAX_BLOCK['X'] to 4096
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] The above exception was the direct cause of the following exception:
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Traceback (most recent call last):
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1064, in __call__
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     result = self._inner_convert(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 526, in __call__
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _compile(
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 924, in _compile
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 666, in compile_inner
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_utils_internal.py", line 87, in wrapper_function
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return function(*args, **kwargs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 699, in _compile_inner
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     out_code = transform_code_object(code, transform)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1322, in transform_code_object
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     transformations(instructions, code_options)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 219, in _fn
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return fn(*args, **kwargs)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 634, in transform
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     tracer.run()
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2796, in run
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     super().run()
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 983, in run
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     while self.step():
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 895, in step
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 580, in wrapper
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return handle_graph_break(self, inst, speculation.reason)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 649, in handle_graph_break
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.output.compile_subgraph(self, reason=reason)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1142, in compile_subgraph
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1369, in compile_and_call_fx_graph
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = self.call_user_compiler(gm)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1416, in call_user_compiler
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self._call_user_compiler(gm)
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1465, in _call_user_compiler
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     raise BackendCompilerFailed(self.compiler_fn, e) from e
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] torch._dynamo.exc.BackendCompilerFailed: backend='compile_fn' raised:
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] AssertionError: increase TRITON_MAX_BLOCK['X'] to 4096
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information
[rank0]:W0113 22:44:48.268000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] WON'T CONVERT forward /fs/scratch/PAS2473/ICML2025/dart/models/networks/basic_vae.py line 197
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] due to:
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Traceback (most recent call last):
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1446, in _call_user_compiler
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = compiler_fn(gm, self.example_inputs())
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/backends/distributed.py", line 506, in compile_fn
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self.backend_compile_fn(gm, example_inputs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/repro/after_dynamo.py", line 129, in __call__
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_gm = compiler_fn(gm, example_inputs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/__init__.py", line 2234, in __call__
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return compile_fx(model_, inputs_, config_patches=self.config)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1521, in compile_fx
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return aot_autograd(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/backends/common.py", line 72, in __call__
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     cg = aot_module_simplified(gm, example_inputs, **self.kwargs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1071, in aot_module_simplified
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = dispatch_and_compile()
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1056, in dispatch_and_compile
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn, _ = create_aot_dispatcher_function(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 522, in create_aot_dispatcher_function
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _create_aot_dispatcher_function(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 759, in _create_aot_dispatcher_function
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn, fw_metadata = compiler_fn(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/jit_compile_runtime_wrappers.py", line 179, in aot_dispatch_base
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fw = compiler(fw_module, updated_flat_args)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1350, in fw_compiler_base
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _fw_compiler_base(model, example_inputs, is_inference)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1421, in _fw_compiler_base
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return inner_compile(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 475, in compile_fx_inner
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return wrap_compiler_debug(_compile_fx_inner, compiler_name="inductor")(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/repro/after_aot.py", line 85, in debug_wrapper
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     inner_compiled_fn = compiler_fn(gm, example_inputs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 661, in _compile_fx_inner
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = FxGraphCache.load(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1334, in load
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = compile_fx_fn(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 570, in codegen_and_compile
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = fx_codegen_and_compile(gm, example_inputs, **fx_kwargs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 878, in fx_codegen_and_compile
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = graph.compile_to_fn()
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1913, in compile_to_fn
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self.compile_to_module().call
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1839, in compile_to_module
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self._compile_to_module()
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1867, in _compile_to_module
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = PyCodeCache.load_by_key_path(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = _reload_python_module(key, path)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     exec(code, mod.__dict__, mod.__dict__)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/tmp/slurmtmp.281813/torchinductor_brucewan666/cz/ccz6ogc72dnuzgrbao7amdugtuim3wyv43ohuxrwgbx7o4s2jjkd.py", line 193, in <module>
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     triton_poi_fused__to_copy_native_group_norm_silu_3 = async_compile.triton('triton_', '''
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/async_compile.py", line 188, in triton
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     kernel = TritonCodeCache.load(kernel_name, source_code)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2926, in load
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _module_to_triton_kernel(PyCodeCache.load(source_code), kernel_name)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2863, in load
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return cls.load_by_key_path(key, path, linemap, attrs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = _reload_python_module(key, path)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     exec(code, mod.__dict__, mod.__dict__)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/tmp/slurmtmp.281813/torchinductor_brucewan666/b6/cb6jibpjwzb7zu5ysllqdmheceu5bpbjpvsg7pvxci5cawtku52d.py", line 10, in <module>
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     @triton_heuristics.pointwise(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/triton_heuristics.py", line 1368, in pointwise
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     triton_config_with_settings(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/triton_heuristics.py", line 1244, in triton_config
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     assert x <= TRITON_MAX_BLOCK["X"], f"increase TRITON_MAX_BLOCK['X'] to {x}"
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] AssertionError: increase TRITON_MAX_BLOCK['X'] to 4096
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] The above exception was the direct cause of the following exception:
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Traceback (most recent call last):
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1064, in __call__
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     result = self._inner_convert(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 526, in __call__
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _compile(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 924, in _compile
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 666, in compile_inner
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_utils_internal.py", line 87, in wrapper_function
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return function(*args, **kwargs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 699, in _compile_inner
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     out_code = transform_code_object(code, transform)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1322, in transform_code_object
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     transformations(instructions, code_options)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 219, in _fn
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return fn(*args, **kwargs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 634, in transform
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     tracer.run()
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2796, in run
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     super().run()
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 983, in run
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     while self.step():
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 895, in step
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2987, in RETURN_VALUE
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self._return(inst)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2972, in _return
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.output.compile_subgraph(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1117, in compile_subgraph
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.compile_and_call_fx_graph(tx, list(reversed(stack_values)), root)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1369, in compile_and_call_fx_graph
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = self.call_user_compiler(gm)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1416, in call_user_compiler
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self._call_user_compiler(gm)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1465, in _call_user_compiler
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     raise BackendCompilerFailed(self.compiler_fn, e) from e
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] torch._dynamo.exc.BackendCompilerFailed: backend='compile_fn' raised:
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] AssertionError: increase TRITON_MAX_BLOCK['X'] to 4096
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Traceback (most recent call last):
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1446, in _call_user_compiler
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = compiler_fn(gm, self.example_inputs())
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/backends/distributed.py", line 506, in compile_fn
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self.backend_compile_fn(gm, example_inputs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/repro/after_dynamo.py", line 129, in __call__
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_gm = compiler_fn(gm, example_inputs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/__init__.py", line 2234, in __call__
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return compile_fx(model_, inputs_, config_patches=self.config)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1521, in compile_fx
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return aot_autograd(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/backends/common.py", line 72, in __call__
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     cg = aot_module_simplified(gm, example_inputs, **self.kwargs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1071, in aot_module_simplified
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = dispatch_and_compile()
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1056, in dispatch_and_compile
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn, _ = create_aot_dispatcher_function(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 522, in create_aot_dispatcher_function
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _create_aot_dispatcher_function(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 759, in _create_aot_dispatcher_function
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn, fw_metadata = compiler_fn(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/jit_compile_runtime_wrappers.py", line 179, in aot_dispatch_base
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fw = compiler(fw_module, updated_flat_args)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1350, in fw_compiler_base
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _fw_compiler_base(model, example_inputs, is_inference)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1421, in _fw_compiler_base
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return inner_compile(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 475, in compile_fx_inner
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return wrap_compiler_debug(_compile_fx_inner, compiler_name="inductor")(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/repro/after_aot.py", line 85, in debug_wrapper
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     inner_compiled_fn = compiler_fn(gm, example_inputs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 661, in _compile_fx_inner
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = FxGraphCache.load(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1334, in load
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = compile_fx_fn(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 570, in codegen_and_compile
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = fx_codegen_and_compile(gm, example_inputs, **fx_kwargs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 878, in fx_codegen_and_compile
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = graph.compile_to_fn()
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1913, in compile_to_fn
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self.compile_to_module().call
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1839, in compile_to_module
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self._compile_to_module()
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1867, in _compile_to_module
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = PyCodeCache.load_by_key_path(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = _reload_python_module(key, path)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     exec(code, mod.__dict__, mod.__dict__)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/tmp/slurmtmp.281813/torchinductor_brucewan666/cz/ccz6ogc72dnuzgrbao7amdugtuim3wyv43ohuxrwgbx7o4s2jjkd.py", line 193, in <module>
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     triton_poi_fused__to_copy_native_group_norm_silu_3 = async_compile.triton('triton_', '''
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/async_compile.py", line 188, in triton
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     kernel = TritonCodeCache.load(kernel_name, source_code)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2926, in load
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _module_to_triton_kernel(PyCodeCache.load(source_code), kernel_name)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2863, in load
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return cls.load_by_key_path(key, path, linemap, attrs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = _reload_python_module(key, path)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     exec(code, mod.__dict__, mod.__dict__)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/tmp/slurmtmp.281813/torchinductor_brucewan666/b6/cb6jibpjwzb7zu5ysllqdmheceu5bpbjpvsg7pvxci5cawtku52d.py", line 10, in <module>
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     @triton_heuristics.pointwise(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/triton_heuristics.py", line 1368, in pointwise
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     triton_config_with_settings(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/triton_heuristics.py", line 1244, in triton_config
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     assert x <= TRITON_MAX_BLOCK["X"], f"increase TRITON_MAX_BLOCK['X'] to {x}"
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] AssertionError: increase TRITON_MAX_BLOCK['X'] to 4096
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] The above exception was the direct cause of the following exception:
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Traceback (most recent call last):
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1064, in __call__
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     result = self._inner_convert(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 526, in __call__
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _compile(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 924, in _compile
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 666, in compile_inner
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_utils_internal.py", line 87, in wrapper_function
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return function(*args, **kwargs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 699, in _compile_inner
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     out_code = transform_code_object(code, transform)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1322, in transform_code_object
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     transformations(instructions, code_options)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 219, in _fn
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return fn(*args, **kwargs)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 634, in transform
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     tracer.run()
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2796, in run
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     super().run()
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 983, in run
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     while self.step():
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 895, in step
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2987, in RETURN_VALUE
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self._return(inst)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2972, in _return
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.output.compile_subgraph(
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1117, in compile_subgraph
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.compile_and_call_fx_graph(tx, list(reversed(stack_values)), root)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1369, in compile_and_call_fx_graph
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = self.call_user_compiler(gm)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1416, in call_user_compiler
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self._call_user_compiler(gm)
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1465, in _call_user_compiler
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     raise BackendCompilerFailed(self.compiler_fn, e) from e
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] torch._dynamo.exc.BackendCompilerFailed: backend='compile_fn' raised:
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] AssertionError: increase TRITON_MAX_BLOCK['X'] to 4096
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information
[rank0]:W0113 22:44:53.492000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] WON'T CONVERT forward /fs/scratch/PAS2473/ICML2025/dart/models/networks/basic_vae.py line 80
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] due to:
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Traceback (most recent call last):
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1446, in _call_user_compiler
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = compiler_fn(gm, self.example_inputs())
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/backends/distributed.py", line 506, in compile_fn
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self.backend_compile_fn(gm, example_inputs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/repro/after_dynamo.py", line 129, in __call__
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_gm = compiler_fn(gm, example_inputs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/__init__.py", line 2234, in __call__
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return compile_fx(model_, inputs_, config_patches=self.config)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1521, in compile_fx
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return aot_autograd(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/backends/common.py", line 72, in __call__
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     cg = aot_module_simplified(gm, example_inputs, **self.kwargs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1071, in aot_module_simplified
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = dispatch_and_compile()
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1056, in dispatch_and_compile
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn, _ = create_aot_dispatcher_function(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 522, in create_aot_dispatcher_function
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _create_aot_dispatcher_function(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 759, in _create_aot_dispatcher_function
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn, fw_metadata = compiler_fn(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/jit_compile_runtime_wrappers.py", line 179, in aot_dispatch_base
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fw = compiler(fw_module, updated_flat_args)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1350, in fw_compiler_base
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _fw_compiler_base(model, example_inputs, is_inference)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1421, in _fw_compiler_base
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return inner_compile(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 475, in compile_fx_inner
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return wrap_compiler_debug(_compile_fx_inner, compiler_name="inductor")(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/repro/after_aot.py", line 85, in debug_wrapper
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     inner_compiled_fn = compiler_fn(gm, example_inputs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 661, in _compile_fx_inner
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = FxGraphCache.load(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1334, in load
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = compile_fx_fn(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 570, in codegen_and_compile
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = fx_codegen_and_compile(gm, example_inputs, **fx_kwargs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 878, in fx_codegen_and_compile
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = graph.compile_to_fn()
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1913, in compile_to_fn
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self.compile_to_module().call
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1839, in compile_to_module
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self._compile_to_module()
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1867, in _compile_to_module
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = PyCodeCache.load_by_key_path(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = _reload_python_module(key, path)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     exec(code, mod.__dict__, mod.__dict__)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/tmp/slurmtmp.281813/torchinductor_brucewan666/el/celgxaz5yac6woscspav54wwpmctacqaeuwdwo7jbzsxa5w65vuk.py", line 273, in <module>
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     triton_poi_fused__to_copy_native_group_norm_silu_4 = async_compile.triton('triton_', '''
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/async_compile.py", line 188, in triton
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     kernel = TritonCodeCache.load(kernel_name, source_code)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2926, in load
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _module_to_triton_kernel(PyCodeCache.load(source_code), kernel_name)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2863, in load
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return cls.load_by_key_path(key, path, linemap, attrs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = _reload_python_module(key, path)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     exec(code, mod.__dict__, mod.__dict__)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/tmp/slurmtmp.281813/torchinductor_brucewan666/tm/ctm5l2ac7oletpqogwddm3wild2mpi7ab7d4m3f4gtwfuq2bbwoj.py", line 10, in <module>
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     @triton_heuristics.pointwise(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/triton_heuristics.py", line 1368, in pointwise
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     triton_config_with_settings(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/triton_heuristics.py", line 1244, in triton_config
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     assert x <= TRITON_MAX_BLOCK["X"], f"increase TRITON_MAX_BLOCK['X'] to {x}"
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] AssertionError: increase TRITON_MAX_BLOCK['X'] to 4096
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] The above exception was the direct cause of the following exception:
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Traceback (most recent call last):
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1064, in __call__
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     result = self._inner_convert(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 526, in __call__
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _compile(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 924, in _compile
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 666, in compile_inner
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_utils_internal.py", line 87, in wrapper_function
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return function(*args, **kwargs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 699, in _compile_inner
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     out_code = transform_code_object(code, transform)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1322, in transform_code_object
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     transformations(instructions, code_options)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 219, in _fn
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return fn(*args, **kwargs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 634, in transform
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     tracer.run()
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2796, in run
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     super().run()
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 983, in run
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     while self.step():
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 895, in step
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2987, in RETURN_VALUE
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self._return(inst)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2972, in _return
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.output.compile_subgraph(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1117, in compile_subgraph
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.compile_and_call_fx_graph(tx, list(reversed(stack_values)), root)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1369, in compile_and_call_fx_graph
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = self.call_user_compiler(gm)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1416, in call_user_compiler
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self._call_user_compiler(gm)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1465, in _call_user_compiler
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     raise BackendCompilerFailed(self.compiler_fn, e) from e
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] torch._dynamo.exc.BackendCompilerFailed: backend='compile_fn' raised:
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] AssertionError: increase TRITON_MAX_BLOCK['X'] to 4096
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Traceback (most recent call last):
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1446, in _call_user_compiler
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = compiler_fn(gm, self.example_inputs())
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/backends/distributed.py", line 506, in compile_fn
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self.backend_compile_fn(gm, example_inputs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/repro/after_dynamo.py", line 129, in __call__
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_gm = compiler_fn(gm, example_inputs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/__init__.py", line 2234, in __call__
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return compile_fx(model_, inputs_, config_patches=self.config)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1521, in compile_fx
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return aot_autograd(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/backends/common.py", line 72, in __call__
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     cg = aot_module_simplified(gm, example_inputs, **self.kwargs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1071, in aot_module_simplified
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = dispatch_and_compile()
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1056, in dispatch_and_compile
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn, _ = create_aot_dispatcher_function(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 522, in create_aot_dispatcher_function
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _create_aot_dispatcher_function(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 759, in _create_aot_dispatcher_function
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn, fw_metadata = compiler_fn(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/jit_compile_runtime_wrappers.py", line 179, in aot_dispatch_base
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fw = compiler(fw_module, updated_flat_args)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1350, in fw_compiler_base
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _fw_compiler_base(model, example_inputs, is_inference)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1421, in _fw_compiler_base
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return inner_compile(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 475, in compile_fx_inner
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return wrap_compiler_debug(_compile_fx_inner, compiler_name="inductor")(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/repro/after_aot.py", line 85, in debug_wrapper
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     inner_compiled_fn = compiler_fn(gm, example_inputs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 661, in _compile_fx_inner
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = FxGraphCache.load(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1334, in load
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = compile_fx_fn(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 570, in codegen_and_compile
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_graph = fx_codegen_and_compile(gm, example_inputs, **fx_kwargs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 878, in fx_codegen_and_compile
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = graph.compile_to_fn()
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1913, in compile_to_fn
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self.compile_to_module().call
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1839, in compile_to_module
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self._compile_to_module()
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/graph.py", line 1867, in _compile_to_module
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = PyCodeCache.load_by_key_path(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = _reload_python_module(key, path)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     exec(code, mod.__dict__, mod.__dict__)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/tmp/slurmtmp.281813/torchinductor_brucewan666/el/celgxaz5yac6woscspav54wwpmctacqaeuwdwo7jbzsxa5w65vuk.py", line 273, in <module>
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     triton_poi_fused__to_copy_native_group_norm_silu_4 = async_compile.triton('triton_', '''
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/async_compile.py", line 188, in triton
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     kernel = TritonCodeCache.load(kernel_name, source_code)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2926, in load
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _module_to_triton_kernel(PyCodeCache.load(source_code), kernel_name)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2863, in load
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return cls.load_by_key_path(key, path, linemap, attrs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     mod = _reload_python_module(key, path)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     exec(code, mod.__dict__, mod.__dict__)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/tmp/slurmtmp.281813/torchinductor_brucewan666/tm/ctm5l2ac7oletpqogwddm3wild2mpi7ab7d4m3f4gtwfuq2bbwoj.py", line 10, in <module>
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     @triton_heuristics.pointwise(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/triton_heuristics.py", line 1368, in pointwise
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     triton_config_with_settings(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_inductor/runtime/triton_heuristics.py", line 1244, in triton_config
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     assert x <= TRITON_MAX_BLOCK["X"], f"increase TRITON_MAX_BLOCK['X'] to {x}"
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] AssertionError: increase TRITON_MAX_BLOCK['X'] to 4096
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] The above exception was the direct cause of the following exception:
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Traceback (most recent call last):
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1064, in __call__
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     result = self._inner_convert(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 526, in __call__
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _compile(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 924, in _compile
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 666, in compile_inner
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_utils_internal.py", line 87, in wrapper_function
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return function(*args, **kwargs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 699, in _compile_inner
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     out_code = transform_code_object(code, transform)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1322, in transform_code_object
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     transformations(instructions, code_options)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 219, in _fn
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return fn(*args, **kwargs)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 634, in transform
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     tracer.run()
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2796, in run
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     super().run()
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 983, in run
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     while self.step():
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 895, in step
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2987, in RETURN_VALUE
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self._return(inst)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2972, in _return
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.output.compile_subgraph(
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1117, in compile_subgraph
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     self.compile_and_call_fx_graph(tx, list(reversed(stack_values)), root)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1369, in compile_and_call_fx_graph
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     compiled_fn = self.call_user_compiler(gm)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1416, in call_user_compiler
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     return self._call_user_compiler(gm)
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1465, in _call_user_compiler
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]     raise BackendCompilerFailed(self.compiler_fn, e) from e
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] torch._dynamo.exc.BackendCompilerFailed: backend='compile_fn' raised:
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] AssertionError: increase TRITON_MAX_BLOCK['X'] to 4096
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125] Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information
[rank0]:W0113 22:44:54.202000 3923616 site-packages/torch/_dynamo/convert_frame.py:1125]
  0%|                                                                                                                            | 0/13617 [00:39<?, ?it/s]
  0%|                                                                                                                              | 0/100 [00:39<?, ?it/s]
Traceback (most recent call last):
  File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 438, in <module>
    main(args)
  File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 277, in main
    out = vae_model(imgs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1643, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 465, in _fn
    return fn(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/scratch/PAS2473/ICML2025/dart/models/autoencoder/dart_autoencoder.py", line 146, in forward
    self.quant_conv(self.encoder(input)),
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/scratch/PAS2473/ICML2025/dart/models/networks/basic_vae.py", line 202, in forward
    h = self.down[i_level].block[i_block](h)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/scratch/PAS2473/ICML2025/dart/models/networks/basic_vae.py", line 81, in forward
    h = self.conv1(F.silu(self.norm1(x), inplace=True))
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/normalization.py", line 313, in forward
    return F.group_norm(input, self.num_groups, self.weight, self.bias, self.eps)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/functional.py", line 2955, in group_norm
    return torch.group_norm(
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 40.00 GiB. GPU 0 has a total capacity of 79.14 GiB of which 16.60 GiB is free. Including non-PyTorch memory, this process has 62.48 GiB memory in use. Of the allocated memory 61.48 GiB is allocated by PyTorch, and 193.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank0]: Traceback (most recent call last):
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 438, in <module>
[rank0]:     main(args)
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 277, in main
[rank0]:     out = vae_model(imgs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1643, in forward
[rank0]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
[rank0]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 465, in _fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/models/autoencoder/dart_autoencoder.py", line 146, in forward
[rank0]:     self.quant_conv(self.encoder(input)),
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/models/networks/basic_vae.py", line 202, in forward
[rank0]:     h = self.down[i_level].block[i_block](h)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/models/networks/basic_vae.py", line 81, in forward
[rank0]:     h = self.conv1(F.silu(self.norm1(x), inplace=True))
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/normalization.py", line 313, in forward
[rank0]:     return F.group_norm(input, self.num_groups, self.weight, self.bias, self.eps)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/functional.py", line 2955, in group_norm
[rank0]:     return torch.group_norm(
[rank0]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 40.00 GiB. GPU 0 has a total capacity of 79.14 GiB of which 16.60 GiB is free. Including non-PyTorch memory, this process has 62.48 GiB memory in use. Of the allocated memory 61.48 GiB is allocated by PyTorch, and 193.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
