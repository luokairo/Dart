  0%|                                                                                                                                           | 0/4 [00:00<?, ?it/s][[34m2025-01-21 00:02:44[0m] Begin epoch 0...
                                                                                                                                                                      We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
/fs/scratch/PAS2473/ICML2025/dart/models/autoencoder/quantize/dart_quantize.py:47: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
                                                                                                                                                                      [[34m2025-01-21 00:05:29[0m] (Generator) rec_loss: 0.0123, perceptual_loss: 0.1069, vq_loss: 6.6424,codebook_usage: 99.8047, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-21 00:05:30[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.4961, logits_fake: -1.49752:42<2:23:29,  3.13s/it]
[[34m2025-01-21 00:05:30[0m] (step=0000050) Train Loss: 7.0390, Batch rFID: 370.5496, Batch gFID: 3499.5110, Avg rFID: 462.5238, Avg gFID: 3348.2710, continuous: 0.5246, discrete: 0.4754Train Steps/Sec: 0.30
                                                                                                                                                                      /fs/scratch/PAS2473/ICML2025/dart/models/autoencoder/quantize/dart_quantize.py:47: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):                                                                                    | 50/2802 [02:46<2:29:35,  3.26s/it]
                                                                                                                                                                      [[34m2025-01-21 00:08:06[0m] (Generator) rec_loss: 0.0111, perceptual_loss: 0.1112, vq_loss: 6.8273,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-21 00:08:07[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5288, logits_fake: -1.52465:19<2:20:39,  3.12s/it]
[[34m2025-01-21 00:08:07[0m] (step=0000100) Train Loss: 7.1328, Batch rFID: 442.4287, Batch gFID: 3484.4438, Avg rFID: 431.6808, Avg gFID: 3448.3238, continuous: 0.5493, discrete: 0.4507Train Steps/Sec: 0.32
                                                                                                                                                                      [[34m2025-01-21 00:10:42[0m] (Generator) rec_loss: 0.0088, perceptual_loss: 0.0971, vq_loss: 6.5644,codebook_usage: 100.0000, generator_adv_loss: 0.0000, disc_adaptive_weight: 1.0000, disc_weight: 0.0000
[[34m2025-01-21 00:10:43[0m] (Discriminator) discriminator_adv_loss: 0.0000, disc_weight: 0.0000, logits_real: -1.5139, logits_fake: -1.51327:55<2:17:50,  3.12s/it]
[[34m2025-01-21 00:10:43[0m] (step=0000150) Train Loss: 7.1428, Batch rFID: 416.0115, Batch gFID: 3355.1824, Avg rFID: 428.0979, Avg gFID: 3498.7812, continuous: 0.5735, discrete: 0.4265Train Steps/Sec: 0.32
  6%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                                                                    | 178/2802 [09:26<2:19:16,  3.18s/it]
  0%|                                                                                                                                           | 0/4 [09:26<?, ?it/s]
Traceback (most recent call last):
  File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 546, in <module>
    main(args)
  File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 320, in main
    out = vae_model(imgs, context_tenser)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1643, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/scratch/PAS2473/ICML2025/dart/models/autoencoder/dart_autoencoder.py", line 158, in forward
    con_h_BChw, usages, vq_loss, _ = self.quantize(
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/scratch/PAS2473/ICML2025/dart/models/autoencoder/quantize/dart_quantize.py", line 84, in forward
    hit_V = idx_N.bincount(minlength=self.vocab_size).float()
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 546, in <module>
[rank0]:     main(args)
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 320, in main
[rank0]:     out = vae_model(imgs, context_tenser)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1643, in forward
[rank0]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
[rank0]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/models/autoencoder/dart_autoencoder.py", line 158, in forward
[rank0]:     con_h_BChw, usages, vq_loss, _ = self.quantize(
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/users/PAS2473/brucewan666/anaconda3/envs/dart/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/models/autoencoder/quantize/dart_quantize.py", line 84, in forward
[rank0]:     hit_V = idx_N.bincount(minlength=self.vocab_size).float()
[rank0]: KeyboardInterrupt
