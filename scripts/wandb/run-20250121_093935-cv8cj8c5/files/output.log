  0%|                                                                                                               | 0/1 [00:00<?, ?it/s][[34m2025-01-21 09:39:36[0m] Begin epoch 0...
                                                                                                                                          We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
/fs/scratch/PAS2473/ICML2025/dart/models/autoencoder/quantize/dart_quantize.py:47: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
/fs/scratch/PAS2473/ICML2025/dart/training/vq_loss.py:59: UserWarning: torch.linalg.svd: During SVD computation with the selected cusolver driver, batches 0 failed to converge. A more accurate method will be used to compute the SVD as a fallback. Check doc at https://pytorch.org/docs/stable/generated/torch.linalg.svd.html (Triggered internally at ../aten/src/ATen/native/cuda/linalg/BatchLinearAlgebraLib.cpp:697.)
  u, s, v = torch.svd(torch.matmul(sigma1, sigma2))
Error computing matrix square root: linalg.svd: The algorithm failed to converge because the input matrix is ill-conditioned or has too many repeated singular values (error code: 999).
  0%|                                                                                                           | 0/11464 [00:11<?, ?it/s]
  0%|                                                                                                               | 0/1 [00:11<?, ?it/s]
Traceback (most recent call last):
  File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 547, in <module>
    main(args)
  File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 340, in main
    rfid = calculate_fid(real_mu, real_sigma, gen_mu, gen_sigma)
  File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_loss.py", line 59, in calculate_fid
    u, s, v = torch.svd(torch.matmul(sigma1, sigma2))
torch._C._LinAlgError: linalg.svd: The algorithm failed to converge because the input matrix is ill-conditioned or has too many repeated singular values (error code: 999).
[rank0]: Traceback (most recent call last):
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 547, in <module>
[rank0]:     main(args)
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_train.py", line 340, in main
[rank0]:     rfid = calculate_fid(real_mu, real_sigma, gen_mu, gen_sigma)
[rank0]:   File "/fs/scratch/PAS2473/ICML2025/dart/training/vq_loss.py", line 59, in calculate_fid
[rank0]:     u, s, v = torch.svd(torch.matmul(sigma1, sigma2))
[rank0]: torch._C._LinAlgError: linalg.svd: The algorithm failed to converge because the input matrix is ill-conditioned or has too many repeated singular values (error code: 999).
